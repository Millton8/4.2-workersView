<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/src/Style/loginStyle.css">
    <link rel="stylesheet" href="/src/Style/mediaTypeStyle.css">
    <title>Вход</title>
</head>
<body>
    <div class="center-screen" id="mainDiv">

            <input type="password" id="password" placeholder="Введите пароль"/><br />
            <button class="btn" type="submit" id="submitLogin"><span>Изменить</span></button>

    </div>
            <script>

                var tokenKey = "accessToken";

                // при нажатии на кнопку отправки формы идет запрос к /login для получения токена
                document.getElementById("submitLogin").addEventListener("click", async e => {
                    e.preventDefault();
                    // отправляет запрос и получаем ответ
                    var pass = document.getElementById("password").value
                    const response = await fetch("/login", {
                        method: "POST",
                        headers: { "Accept": "application/json", "Content-Type": "application/json" },
                        body: JSON.stringify(pass

                        )
                    });
                    // если запрос прошел нормально
                    if (response.ok === true) {
                        // получаем данные
                        const access_token = await response.json();
                        sessionStorage.setItem(tokenKey, access_token);

                        const token1 = sessionStorage.getItem("accessToken")

                        window.location.replace(`/status.html?${access_token}`)

                    }
                    else  // если произошла ошибка, получаем код статуса
                        console.log("Status: ", response.status);
                });



            </script>
</body>
</html>